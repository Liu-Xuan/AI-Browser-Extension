<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' http://172.19.12.146:8888 http://localhost:3000; style-src 'self' 'unsafe-inline' http://172.19.12.146:8888 http://localhost:3000; font-src 'self' http://172.19.12.146:8888 http://localhost:3000; img-src 'self' data: http://172.19.12.146:8888 http://localhost:3000; script-src 'self' 'unsafe-inline' http://172.19.12.146:8888 http://localhost:3000; connect-src 'self' http://172.19.12.146:8888 http://localhost:3000">
    <title>AI助手</title>
    <link rel="stylesheet" href="styles/sidepanel.css">
    <link rel="stylesheet" href="styles/fileList.css">
</head>
<body>
    <div class="sidebar-container">
        <!-- 选项卡导航 -->
        <div class="tab-nav">
            <button class="tab-btn active" data-tab="assistant">智能助手(RAG)</button>
            <button class="tab-btn" data-tab="assistant-local">智能助手(本地)</button>
            <button class="tab-btn" data-tab="knowledge">知识库管理</button>
            <button class="tab-btn" data-tab="toolbox">工具箱</button>
        </div>

        <!-- 选项卡内容 -->
        <div class="tab-content">
            <!-- RAG智能助手选项卡 -->
            <div id="assistant" class="tab-pane active">
                <!-- 临时知识库管理 -->
                <div class="temp-kb-section">
                    <div class="section-header">
                        <h3>临时知识库管理</h3>
                        <div class="action-buttons">
                            <button id="uploadFileBtn" class="primary-btn">
                                <span class="icon">📁</span>上传本地文件
                            </button>
                            <button id="addPageBtn" class="primary-btn">
                                <span class="icon">📄</span>添加当前页面
                            </button>
                            <button id="newChatBtn" class="secondary-btn">
                                <span class="icon">🔄</span>开启新对话
                            </button>
                        </div>
                    </div>
                    
                    <!-- 文件列表 -->
                    <div class="file-list" id="tempKbFiles">
                        <!-- 文件项会通过JavaScript动态添加 -->
                    </div>
                </div>

                <!-- 对话iframe -->
                <div class="chat-iframe-container">
                    <div class="loading-indicator" id="ragLoadingIndicator" style="display: none;">
                        <div class="spinner"></div>
                        <p>正在加载智能助手...</p>
                    </div>
                    <iframe
                        id="chatIframe"
                        src="http://172.19.12.146:8888/chat/share?shared_id=e4021ad6d94911ef9e010242ac120005&from=agent&auth=RkOWJkMGYyZDFhZTExZWZhYmRmMDI0Mm"
                        style="width: 100%; height: 100%; min-height: 600px; border: none; display: block;"
                        sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-modals allow-downloads"
                        frameborder="0"
                    ></iframe>
                </div>
            </div>

            <!-- 本地智能助手选项卡 -->
            <div id="assistant-local" class="tab-pane">
                <!-- 临时知识库管理 -->
                <div class="temp-kb-section">
                    <div class="section-header">
                        <h3>临时知识库管理</h3>
                        <div class="action-buttons">
                            <button id="localUploadFileBtn" class="primary-btn">
                                <span class="icon">📁</span>上传本地文件
                            </button>
                            <button id="localAddPageBtn" class="primary-btn">
                                <span class="icon">📄</span>添加当前页面
                            </button>
                            <button id="localNewChatBtn" class="secondary-btn">
                                <span class="icon">🔄</span>开启新对话
                            </button>
                        </div>
                    </div>
                    
                    <!-- 文件列表 -->
                    <div class="file-list" id="localTempKbFiles">
                        <!-- 文件项会通过JavaScript动态添加 -->
                    </div>
                </div>

                <!-- 本地对话iframe -->
                <div class="chat-iframe-container">
                    <div class="loading-indicator" id="localLoadingIndicator" style="display: none;">
                        <div class="spinner"></div>
                        <p>正在加载本地助手...</p>
                    </div>
                    <iframe
                        id="localChatIframe"
                        src="http://localhost:3000"
                        style="width: 100%; height: 100%; min-height: 600px; border: none; display: block;"
                        sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-modals allow-downloads"
                    ></iframe>
                </div>
            </div>

            <!-- 知识库管理选项卡 -->
            <div id="knowledge" class="tab-pane">
                <h2>知识库管理</h2>
                <!-- 知识库管理内容将在后续添加 -->
            </div>

            <!-- 工具箱选项卡 -->
            <div id="toolbox" class="tab-pane">
                <h2>工具箱</h2>
                <!-- 工具箱内容将在后续添加 -->
            </div>
        </div>
    </div>

    <script src="scripts/fileList.js"></script>
    <script src="scripts/sidepanel.js" type="module"></script>
</body>
</html> 